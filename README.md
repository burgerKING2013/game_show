the code is kind of messy
